<!DOCTYPE html>
<meta charset="UTF-8"> 
<html>
<canvas id="canvas"></canvas>
<head>
<script>

deltas = [0,1000,1000];
deltas_len = deltas.length;
idx = 0;
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");


function post(path, params, method) {
    method = method || "post"; // Set method to post by default if not specified.
    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);
    for(var key in params) {
        if(params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
         }
    }

    document.body.appendChild(form);
    form.submit();
}

var accTime = 0
function playNote() {
	if (idx >= deltas_len) {
		//post('http://127.0.0.1:5000/foo', {foo: 'bar'});
		setTimeout(start, deltas[idx-1]);
		return;
	}
	var offset = (deltas[idx] + accTime) / 20;
	ctx.moveTo(offset, 100);
	ctx.lineTo(offset, 200);
	ctx.stroke();
	accTime += deltas[idx];
	setTimeout(playNote, deltas[++idx]);
}
function start() {
	idx = 0;
	accTime = 0;
	ctx.beginPath();
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	setTimeout(playNote, deltas[idx]);
}
window.addEventListener("keydown", dealWithKeyboard, false);

user_notes = [] 
function dealWithKeyboard(e) {
	ts = new Date().getTime();
	user_notes.push(ts)
	console.log("prss: "+ user_notes);
}
</script>
</head>

<body onload="start()">
<!-- <input type="text" onkeypress="note()"> -->

</body>
</html>

